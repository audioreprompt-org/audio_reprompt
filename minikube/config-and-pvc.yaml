# minikube/config-and-pvc.yaml
# --- CONFIGMAP (Para variables de entorno y configuración estática) ---
apiVersion: v1
kind: ConfigMap
metadata:
  name: audio-reprompt-config
data:
  AWS_REGION: us-east-1
  BUCKET_NAME: audio-generations-audio-reprompt

  # Contenido del archivo config.yaml (simulación de un archivo)
  config.yaml: |
    # Audio Reprompt Configuration - Mínimo necesario

    # Model configuration (Rutas esenciales para la carga del modelo)
    model:
      model_musicgen_path: "models/tasty-musicgen-small"
      laion_clap_path: "https://huggingface.co/lukewys/laion_clap/resolve/main/music_audioset_epoch_15_esc_90.14.pt"
      
    # Logging configuration
    logging:
      level: "INFO"
      
    # Environment configuration (Necesario si lo usas para cargar la configuración general)
    environment:
      bucket_name: "audio-generations-audio-reprompt"
      device: "auto"
---
# --- PERSISTENT VOLUME CLAIM (Para modelos y datos locales) ---
# Esto sustituye a los volúmenes de Docker Compose (../models, ../data)
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: audio-reprompt-pvc
spec:
  # Permite que el volumen sea montado en modo Lectura/Escritura por un único nodo (minikube)
  accessModes:
    - ReadWriteOnce
  resources:
    # Aumentar este valor si los modelos son grandes (MusicGen requiere varios GB)
    requests:
      storage: 10Gi
